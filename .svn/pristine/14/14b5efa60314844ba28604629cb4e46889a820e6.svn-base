package fr.eurecom.mobserv.arianna;

import java.util.ArrayList;
import java.util.List;

import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.Toast;
import fr.eurecom.mobserv.arianna.model.Event;
import fr.eurecom.mobserv.arianna.model.Model;
import fr.eurecom.mobserv.arianna.model.PointOfInterest;

// TODO Use a Loader in order to query the db in a different thread
//	than the main UI's one.
public class PointOfInterestList extends BaseDrawerActivity {

	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		ListView listView = (ListView) findViewById(R.id.point_of_interest_list_view);
		Event event=(Event) Model.getByURI(Event.class, "E0", getApplicationContext()); 
		List<PointOfInterest> pois =new ArrayList<PointOfInterest>( event.getPois().values());
		ArrayAdapter<PointOfInterest> adapter = new PointOfInterestArrayAdapter(this, pois);
		listView.setAdapter(adapter);
		listView.setOnItemClickListener(new OnItemClickListener() {
			public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
				PointOfInterest item = (PointOfInterest) parent.getAdapter().getItem(position);
				Intent intentDetail = new Intent(getApplicationContext(), PointOfInterestDetail.class);
				intentDetail.putExtra(DashboardActivity.EXTRA_URI, item.getUri());
				intentDetail.putExtra(DashboardActivity.EXTRA_LAUNCHER, DashboardActivity.LAUNCHER_POI_LIST);
				startActivity(intentDetail);
				// TODO DEBUG
				Toast.makeText(getApplicationContext(), item.getTitle() + " selected", Toast.LENGTH_LONG).show();
				
			}
		});
	}
	

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.activity_point_of_interest_list, menu);
		return true;
	}
	
	@Override
	protected int getContentViewResource() {
		return R.layout.activity_point_of_interest_list;
	}

}